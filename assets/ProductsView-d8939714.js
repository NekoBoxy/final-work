import{a as f}from"./axios-bff3f665.js";import{_ as v,M as P,o as i,a,e as t,g as y,t as _,l as c,q as r,F as g,f as x,u as U,r as p,b,x as C}from"./index-794ac18e.js";import{C as $}from"./CPagination-bf0ce565.js";const M={props:{product:Object,on_finish:Function},data(){return{}},methods:{show(){this.modal.show()},hide(){this.modal.hide()},async handleRemove(){await f({method:"delete",url:`https://vue3-course-api.hexschool.io/v2/api/catboxy/admin/product/${this.product.id}`}).catch(l=>{console.log("error",l)}),console.log("已刪除"),this.hide(),this.$emit("on_finish")}},async mounted(){this.modal=new P(this.$refs.modal)}},V={ref:"modal",class:"modal fade",tabindex:"-1","aria-labelledby":"delProductModalLabel","aria-hidden":"true"},D={class:"modal-dialog"},E={class:"modal-content border-0"},O=t("div",{class:"modal-header bg-danger text-white"},[t("h5",{id:"delProductModalLabel",class:"modal-title"},[t("span",null,"刪除產品")]),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),A={class:"modal-body"},I={class:"text-danger"},L={class:"modal-footer"},S=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function F(l,o,u,w,e,n){return i(),a("div",V,[t("div",D,[t("div",E,[O,t("div",A,[y(" 是否刪除 "),t("strong",I,_(u.product.title),1),y(" 商品(刪除後將無法恢復)。 ")]),t("div",L,[S,t("button",{type:"button",class:"btn btn-danger",onClick:o[0]||(o[0]=s=>n.handleRemove())}," 確認刪除 ")])])])],512)}const B=v(M,[["render",F]]),N={props:{status:String,product:{type:Object,default(){return{imagesUrl:[]}}},on_finish:Function},data(){return{newProduct:{imagesUrl:[]},modal:null}},watch:{product(l){this.newProduct={...l}}},methods:{show(){this.modal.show()},hide(){this.modal.hide()},async handleSubmit(){try{let l="",o="";this.status==="new"?(l="post",o="https://vue3-course-api.hexschool.io/v2/api/catboxy/admin/product"):(l="put",o=`https://vue3-course-api.hexschool.io/v2/api/catboxy/admin/product/${this.newProduct.id}`),await f({method:l,url:o,data:{data:this.newProduct}}).catch(u=>{throw u.response.data.message}),this.modal.hide(),this.$emit("on_finish")}catch(l){alert(l)}},addImage(){this.newProduct.imagesUrl||(this.newProduct.imagesUrl=[]),this.newProduct.imagesUrl.push("")},removeImage(l){this.newProduct.imagesUrl.splice(l,1)}},mounted(){this.modal=new P(this.$refs.modal)}},j={ref:"modal",class:"modal fade",tabindex:"-1","aria-labelledby":"productModalLabel","aria-hidden":"true"},z={class:"modal-dialog modal-xl"},R={class:"modal-content border-0"},T={class:"modal-header bg-dark text-white"},q={id:"productModalLabel",class:"modal-title"},G={key:0},H={key:1},J=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),K={class:"modal-body"},Q={class:"row"},W={class:"col-sm-4"},X={class:"mb-2"},Y={class:"mb-3"},Z=t("label",{for:"imageUrl",class:"form-label"},"輸入主圖片網址",-1),tt=["src","alt"],ot=t("hr",null,null,-1),et=t("hr",null,null,-1),st={class:"mb-3"},lt=t("label",{for:"imageUrl",class:"form-label"},"輸入圖片網址",-1),nt=["onUpdate:modelValue"],dt=["src","alt"],it=["onClick"],at={class:"col-sm-8"},ct={class:"mb-3"},rt=t("label",{for:"title",class:"form-label"},"標題",-1),ut={class:"row"},mt={class:"mb-3 col-md-6"},_t=t("label",{for:"category",class:"form-label"},"分類",-1),ht={class:"mb-3 col-md-6"},pt=t("label",{for:"price",class:"form-label"},"單位",-1),bt={class:"row"},gt={class:"mb-3 col-md-6"},ft=t("label",{for:"origin_price",class:"form-label"},"原價",-1),vt={class:"mb-3 col-md-6"},wt=t("label",{for:"price",class:"form-label"},"售價",-1),yt=t("hr",null,null,-1),Pt={class:"mb-3"},xt=t("label",{for:"description",class:"form-label"},"產品描述",-1),kt={class:"mb-3"},Ut=t("label",{for:"content",class:"form-label"},"說明內容",-1),Ct={class:"mb-3"},$t={class:"form-check"},Mt=t("label",{class:"form-check-label",for:"is_enabled"},"是否啟用",-1),Vt={class:"modal-footer"},Dt=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function Et(l,o,u,w,e,n){return i(),a("div",j,[t("div",z,[t("div",R,[t("div",T,[t("h5",q,[u.status==="new"?(i(),a("span",G,"新增產品")):(i(),a("span",H,"編輯產品"))]),J]),t("div",K,[t("div",Q,[t("div",W,[t("div",X,[t("div",Y,[Z,c(t("input",{type:"text",class:"form-control",placeholder:"請輸入圖片連結","onUpdate:modelValue":o[0]||(o[0]=s=>e.newProduct.imageUrl=s)},null,512),[[r,e.newProduct.imageUrl]])]),t("img",{class:"img-fluid",src:e.newProduct.imageUrl,alt:e.newProduct.title},null,8,tt)]),ot,t("div",null,[t("button",{class:"btn btn-outline-primary btn-sm d-block w-100",onClick:o[1]||(o[1]=(...s)=>n.addImage&&n.addImage(...s))}," 新增更多圖片 ")]),(i(!0),a(g,null,x(e.newProduct.imagesUrl,(s,m)=>(i(),a("div",{class:"mb-2",key:m},[et,t("div",st,[lt,c(t("input",{type:"text",class:"form-control",placeholder:"請輸入圖片連結","onUpdate:modelValue":h=>e.newProduct.imagesUrl[m]=h},null,8,nt),[[r,e.newProduct.imagesUrl[m]]])]),t("img",{class:"img-fluid",src:s,alt:s},null,8,dt),t("button",{class:"btn btn-outline-danger btn-sm d-block w-100",onClick:h=>n.removeImage(m)}," 刪除圖片 ",8,it)]))),128))]),t("div",at,[t("div",ct,[rt,c(t("input",{id:"title",type:"text",class:"form-control",placeholder:"請輸入標題","onUpdate:modelValue":o[2]||(o[2]=s=>e.newProduct.title=s)},null,512),[[r,e.newProduct.title]])]),t("div",ut,[t("div",mt,[_t,c(t("input",{id:"category",type:"text",class:"form-control",placeholder:"請輸入分類","onUpdate:modelValue":o[3]||(o[3]=s=>e.newProduct.category=s)},null,512),[[r,e.newProduct.category]])]),t("div",ht,[pt,c(t("input",{id:"unit",type:"text",class:"form-control",placeholder:"請輸入單位","onUpdate:modelValue":o[4]||(o[4]=s=>e.newProduct.unit=s)},null,512),[[r,e.newProduct.unit]])])]),t("div",bt,[t("div",gt,[ft,c(t("input",{id:"origin_price",type:"number",min:"0",class:"form-control",placeholder:"請輸入原價","onUpdate:modelValue":o[5]||(o[5]=s=>e.newProduct.origin_price=s)},null,512),[[r,e.newProduct.origin_price]])]),t("div",vt,[wt,c(t("input",{id:"price",type:"number",min:"0",class:"form-control",placeholder:"請輸入售價","onUpdate:modelValue":o[6]||(o[6]=s=>e.newProduct.price=s)},null,512),[[r,e.newProduct.price]])])]),yt,t("div",Pt,[xt,c(t("textarea",{id:"description",type:"text",class:"form-control",placeholder:"請輸入產品描述","onUpdate:modelValue":o[7]||(o[7]=s=>e.newProduct.description=s)},null,512),[[r,e.newProduct.description]])]),t("div",kt,[Ut,c(t("textarea",{id:"content",type:"text",class:"form-control",placeholder:"請輸入說明內容","onUpdate:modelValue":o[8]||(o[8]=s=>e.newProduct.content=s)},null,512),[[r,e.newProduct.content]])]),t("div",Ct,[t("div",$t,[c(t("input",{id:"is_enabled",class:"form-check-input",type:"checkbox","true-value":1,"false-value":0,"onUpdate:modelValue":o[9]||(o[9]=s=>e.newProduct.is_enabled=s)},null,512),[[U,e.newProduct.is_enabled]]),Mt])])])])]),t("div",Vt,[Dt,t("button",{type:"button",class:"btn btn-primary",onClick:o[10]||(o[10]=s=>n.handleSubmit())}," 確認 ")])])])],512)}const Ot=v(N,[["render",Et]]),At={data(){return{status:"",product:{},products:{},pagination:{total_pages:"",current_page:1,has_pre:!1,has_next:!1,category:""}}},components:{CModalProductDelete:B,CModalProductEdit:Ot,CPagination:$},methods:{async addProduct(){this.status="new",this.product={},this.$refs.cModalProductEdit.show()},async editProduct(l){this.status="edit",this.product=l,this.$refs.cModalProductEdit.show()},async delProduct(l){this.product=l,this.$refs.cModalProductDelete.show()},async getAllProducts(l){const o=await f({method:"get",url:"https://vue3-course-api.hexschool.io/v2/api/catboxy/admin/products/",params:{page:l||this.pagination.current_page}}).catch(u=>{console.log("error",u)});this.products=o.data.products,this.pagination=o.data.pagination}},async mounted(){await this.getAllProducts()}},It={class:"text-end mt-4"},Lt={class:"container"},St={class:"row"},Ft={class:"col-12"},Bt={class:"table align-middle"},Nt=t("thead",null,[t("tr",null,[t("td",null,"圖片"),t("td",null,"名稱"),t("td",null,"分類"),t("td",null,"單位(個/unit)"),t("td",null,"原價"),t("td",null,"售價"),t("td",null,"是否啟用"),t("td",null,"編輯"),t("td",null,"刪除")])],-1),jt={style:{width:"200px"}},zt={key:0},Rt={key:1},Tt=["onClick"],qt=["onClick"],Gt=t("tfoot",null,null,-1),Ht={class:"row"},Jt={class:"col-12"};function Kt(l,o,u,w,e,n){const s=p("CModalProductDelete"),m=p("CModalProductEdit"),h=p("CPagination");return i(),a(g,null,[b(s,{product:e.product,onOn_finish:o[0]||(o[0]=d=>n.getAllProducts()),ref:"cModalProductDelete"},null,8,["product"]),b(m,{product:e.product,status:e.status,onOn_finish:o[1]||(o[1]=d=>n.getAllProducts()),ref:"cModalProductEdit"},null,8,["product","status"]),t("div",It,[t("button",{class:"btn btn-outline-primary",onClick:o[2]||(o[2]=d=>n.addProduct())}," 建立新的產品 ")]),t("div",Lt,[t("div",St,[t("div",Ft,[t("table",Bt,[Nt,t("tbody",null,[(i(!0),a(g,null,x(e.products,d=>(i(),a("tr",{key:d.id},[t("td",jt,[t("div",{style:C([{height:"100px","background-size":"cover","background-position":"center"},{"background-image":`url(${d.imageUrl})`}])},null,4)]),t("td",null,_(d.title),1),t("td",null,_(d.category),1),t("td",null,_(d.unit),1),t("td",null,_(d.origin_price),1),t("td",null,_(d.price),1),t("td",null,[d.is_enabled?(i(),a("span",zt,"啟用")):(i(),a("span",Rt,"未啟用"))]),t("td",null,[t("button",{onClick:k=>n.editProduct(d),type:"button",class:"btn btn-outline-secondary"},"編輯",8,Tt)]),t("td",null,[t("button",{onClick:k=>n.delProduct(d),type:"button",class:"btn btn-outline-secondary"},"刪除",8,qt)])]))),128))]),Gt])])]),t("div",Ht,[t("div",Jt,[b(h,{total_pages:e.pagination.total_pages,onOn_page:n.getAllProducts},null,8,["total_pages","onOn_page"])])])])],64)}const Yt=v(At,[["render",Kt]]);export{Yt as default};
