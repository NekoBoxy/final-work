import{a as P}from"./axios-bff3f665.js";import{_ as b,M as y,o as i,c as a,b as t,d as w,t as _,i as c,v as u,F as v,e as x,k as $,r as p,a as f,g as U,f as V}from"./index-90bc9133.js";import{B as A}from"./BPagination-c80ee9df.js";const C={props:{product:Object,on_finish:Function},data(){return{}},methods:{show(){this.modal.show()},hide(){this.modal.hide()},async handleRemove(){await P({method:"delete",url:`https://vue3-course-api.hexschool.io/v2/api/catboxy/admin/product/${this.product.id}`}).catch(l=>{console.log("error",l)}),console.log("已刪除"),this.hide(),this.$emit("on_finish")}},async mounted(){this.modal=new y(this.$refs.modal)}},B={ref:"modal",class:"modal fade",tabindex:"-1","aria-labelledby":"delProductModalLabel","aria-hidden":"true"},M={class:"modal-dialog"},D={class:"modal-content border-0"},E=t("div",{class:"modal-header bg-danger text-white"},[t("h5",{id:"delProductModalLabel",class:"modal-title"},[t("span",null,"刪除產品")]),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),O={class:"modal-body"},I={class:"text-danger"},L={class:"modal-footer"},S=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function F(l,o,r,g,e,n){return i(),a("div",B,[t("div",M,[t("div",D,[E,t("div",O,[w(" 是否刪除 "),t("strong",I,_(r.product.title),1),w(" 商品(刪除後將無法恢復)。 ")]),t("div",L,[S,t("button",{type:"button",class:"btn btn-danger",onClick:o[0]||(o[0]=s=>n.handleRemove())}," 確認刪除 ")])])])],512)}const N=b(C,[["render",F]]),j={props:{status:String,product:{type:Object,default(){return{imagesUrl:[]}}},on_finish:Function},data(){return{newProduct:{imagesUrl:[]},modal:null}},watch:{product(l){this.newProduct={...l}}},methods:{show(){this.modal.show()},hide(){this.modal.hide()},async handleSubmit(){try{let l="",o="";this.status==="new"?(l="post",o="https://vue3-course-api.hexschool.io/v2/api/catboxy/admin/product"):(l="put",o=`https://vue3-course-api.hexschool.io/v2/api/catboxy/admin/product/${this.newProduct.id}`),await P({method:l,url:o,data:{data:this.newProduct}}).catch(r=>{throw r.response.data.message}),this.modal.hide(),this.$emit("on_finish")}catch(l){alert(l)}},addImage(){this.newProduct.imagesUrl||(this.newProduct.imagesUrl=[]),this.newProduct.imagesUrl.push("")},removeImage(l){this.newProduct.imagesUrl.splice(l,1)}},mounted(){this.modal=new y(this.$refs.modal)}},z={ref:"modal",class:"modal fade",tabindex:"-1","aria-labelledby":"productModalLabel","aria-hidden":"true"},R={class:"modal-dialog modal-xl"},T={class:"modal-content border-0"},q={class:"modal-header bg-dark text-white"},G={id:"productModalLabel",class:"modal-title"},H={key:0},J={key:1},K=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),Q={class:"modal-body"},W={class:"row"},X={class:"col-sm-4"},Y={class:"mb-2"},Z={class:"mb-3"},tt=t("label",{for:"imageUrl",class:"form-label"},"輸入主圖片網址",-1),ot=["src","alt"],et=t("hr",null,null,-1),st=t("hr",null,null,-1),lt={class:"mb-3"},nt=t("label",{for:"imageUrl",class:"form-label"},"輸入圖片網址",-1),dt=["onUpdate:modelValue"],it=["src","alt"],at=["onClick"],ct={class:"col-sm-8"},rt={class:"mb-3"},ut=t("label",{for:"title",class:"form-label"},"標題",-1),mt={class:"row"},_t={class:"mb-3 col-md-6"},ht=t("label",{for:"category",class:"form-label"},"分類",-1),pt={class:"mb-3 col-md-6"},bt=t("label",{for:"price",class:"form-label"},"單位",-1),gt={class:"row"},ft={class:"mb-3 col-md-6"},vt=t("label",{for:"origin_price",class:"form-label"},"原價",-1),Pt={class:"mb-3 col-md-6"},wt=t("label",{for:"price",class:"form-label"},"售價",-1),yt=t("hr",null,null,-1),xt={class:"mb-3"},kt=t("label",{for:"description",class:"form-label"},"產品描述",-1),$t={class:"mb-3"},Ut=t("label",{for:"content",class:"form-label"},"說明內容",-1),Vt={class:"mb-3"},At={class:"form-check"},Ct=t("label",{class:"form-check-label",for:"is_enabled"},"是否啟用",-1),Bt={class:"modal-footer"},Mt=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function Dt(l,o,r,g,e,n){return i(),a("div",z,[t("div",R,[t("div",T,[t("div",q,[t("h5",G,[r.status==="new"?(i(),a("span",H,"新增產品")):(i(),a("span",J,"編輯產品"))]),K]),t("div",Q,[t("div",W,[t("div",X,[t("div",Y,[t("div",Z,[tt,c(t("input",{type:"text",class:"form-control",placeholder:"請輸入圖片連結","onUpdate:modelValue":o[0]||(o[0]=s=>e.newProduct.imageUrl=s)},null,512),[[u,e.newProduct.imageUrl]])]),t("img",{class:"img-fluid",src:e.newProduct.imageUrl,alt:e.newProduct.title},null,8,ot)]),et,t("div",null,[t("button",{class:"btn btn-outline-primary btn-sm d-block w-100",onClick:o[1]||(o[1]=(...s)=>n.addImage&&n.addImage(...s))}," 新增更多圖片 ")]),(i(!0),a(v,null,x(e.newProduct.imagesUrl,(s,m)=>(i(),a("div",{class:"mb-2",key:m},[st,t("div",lt,[nt,c(t("input",{type:"text",class:"form-control",placeholder:"請輸入圖片連結","onUpdate:modelValue":h=>e.newProduct.imagesUrl[m]=h},null,8,dt),[[u,e.newProduct.imagesUrl[m]]])]),t("img",{class:"img-fluid",src:s,alt:s},null,8,it),t("button",{class:"btn btn-outline-danger btn-sm d-block w-100",onClick:h=>n.removeImage(m)}," 刪除圖片 ",8,at)]))),128))]),t("div",ct,[t("div",rt,[ut,c(t("input",{id:"title",type:"text",class:"form-control",placeholder:"請輸入標題","onUpdate:modelValue":o[2]||(o[2]=s=>e.newProduct.title=s)},null,512),[[u,e.newProduct.title]])]),t("div",mt,[t("div",_t,[ht,c(t("input",{id:"category",type:"text",class:"form-control",placeholder:"請輸入分類","onUpdate:modelValue":o[3]||(o[3]=s=>e.newProduct.category=s)},null,512),[[u,e.newProduct.category]])]),t("div",pt,[bt,c(t("input",{id:"unit",type:"text",class:"form-control",placeholder:"請輸入單位","onUpdate:modelValue":o[4]||(o[4]=s=>e.newProduct.unit=s)},null,512),[[u,e.newProduct.unit]])])]),t("div",gt,[t("div",ft,[vt,c(t("input",{id:"origin_price",type:"number",min:"0",class:"form-control",placeholder:"請輸入原價","onUpdate:modelValue":o[5]||(o[5]=s=>e.newProduct.origin_price=s)},null,512),[[u,e.newProduct.origin_price]])]),t("div",Pt,[wt,c(t("input",{id:"price",type:"number",min:"0",class:"form-control",placeholder:"請輸入售價","onUpdate:modelValue":o[6]||(o[6]=s=>e.newProduct.price=s)},null,512),[[u,e.newProduct.price]])])]),yt,t("div",xt,[kt,c(t("textarea",{id:"description",type:"text",class:"form-control",placeholder:"請輸入產品描述","onUpdate:modelValue":o[7]||(o[7]=s=>e.newProduct.description=s)},null,512),[[u,e.newProduct.description]])]),t("div",$t,[Ut,c(t("textarea",{id:"content",type:"text",class:"form-control",placeholder:"請輸入說明內容","onUpdate:modelValue":o[8]||(o[8]=s=>e.newProduct.content=s)},null,512),[[u,e.newProduct.content]])]),t("div",Vt,[t("div",At,[c(t("input",{id:"is_enabled",class:"form-check-input",type:"checkbox","true-value":1,"false-value":0,"onUpdate:modelValue":o[9]||(o[9]=s=>e.newProduct.is_enabled=s)},null,512),[[$,e.newProduct.is_enabled]]),Ct])])])])]),t("div",Bt,[Mt,t("button",{type:"button",class:"btn btn-primary",onClick:o[10]||(o[10]=s=>n.handleSubmit())}," 確認 ")])])])],512)}const Et=b(j,[["render",Dt]]),Ot={data(){return{status:"",product:{},products:{},pagination:{total_pages:"",current_page:1,has_pre:!1,has_next:!1,category:""}}},components:{AdminProductDelete:N,AdminProductEdit:Et,BPagination:A},methods:{async addProduct(){this.status="new",this.product={},this.$refs.adminEditProduct.show()},async editProduct(l){this.status="edit",this.product=l,this.$refs.adminEditProduct.show()},async delProduct(l){this.product=l,this.$refs.adminDeleteProduct.show()},async getAllProducts(l){const o=await P({method:"get",url:"https://vue3-course-api.hexschool.io/v2/api/catboxy/admin/products/",params:{page:l||this.pagination.current_page}}).catch(r=>{console.log("error",r)});this.products=o.data.products,this.pagination=o.data.pagination,console.log("已取得遠端產品資料")}},async mounted(){await this.getAllProducts()}},It={class:"text-end mt-4"},Lt={class:"container"},St={class:"row"},Ft={class:"col-12"},Nt={class:"table align-middle"},jt=t("thead",null,[t("tr",null,[t("td",null,"圖片"),t("td",null,"名稱"),t("td",null,"分類"),t("td",null,"單位(個/unit)"),t("td",null,"原價"),t("td",null,"售價"),t("td",null,"是否啟用"),t("td",null,"編輯"),t("td",null,"刪除")])],-1),zt={style:{width:"200px"}},Rt={key:0},Tt={key:1},qt=["onClick"],Gt=["onClick"],Ht=t("tfoot",null,null,-1),Jt={class:"row"},Kt={class:"col-12"};function Qt(l,o,r,g,e,n){const s=p("AdminProductDelete"),m=p("AdminProductEdit"),h=p("BPagination");return i(),a(v,null,[f(s,{product:e.product,onOn_finish:o[0]||(o[0]=d=>n.getAllProducts()),ref:"adminDeleteProduct"},null,8,["product"]),f(m,{product:e.product,status:e.status,onOn_finish:o[1]||(o[1]=d=>n.getAllProducts()),ref:"adminEditProduct"},null,8,["product","status"]),t("div",It,[t("button",{class:"btn btn-primary",onClick:o[2]||(o[2]=d=>n.addProduct())}," 建立新的產品 ")]),t("div",Lt,[t("div",St,[t("div",Ft,[t("table",Nt,[jt,t("tbody",null,[(i(!0),a(v,null,x(e.products,d=>(i(),a("tr",{key:d.id},[t("td",zt,[t("div",{style:U([{height:"100px","background-size":"cover","background-position":"center"},{"background-image":`url(${d.imageUrl})`}])},null,4)]),t("td",null,_(d.title),1),t("td",null,_(d.category),1),t("td",null,_(d.unit),1),t("td",null,_(d.origin_price),1),t("td",null,_(d.price),1),t("td",null,[d.is_enabled?(i(),a("span",Rt,"啟用")):(i(),a("span",Tt,"未啟用"))]),t("td",null,[t("button",{onClick:k=>n.editProduct(d),type:"button",class:"btn btn-outline-secondary"},"編輯",8,qt)]),t("td",null,[t("button",{onClick:k=>n.delProduct(d),type:"button",class:"btn btn-outline-secondary"},"刪除",8,Gt)])]))),128))]),Ht])])]),t("div",Jt,[t("div",Kt,[f(h,{total_pages:e.pagination.total_pages,onOn_page:n.getAllProducts},null,8,["total_pages","onOn_page"])])])])],64)}const Wt=b(Ot,[["render",Qt]]),Xt={components:{AdminProducts:Wt}};function Yt(l,o,r,g,e,n){const s=p("AdminProducts");return i(),V(s)}const eo=b(Xt,[["render",Yt]]);export{eo as default};
