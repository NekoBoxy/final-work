import{a as _}from"./axios-bff3f665.js";import{_ as f,r as d,o as m,c as u,b as e,F as b,e as g,t as c,a as s,w as y,n as i,f as C}from"./index-90bc9133.js";const $={data(){return{data:{},carts:null,final_total:0,total:0}},components:{},methods:{async getCart(){const t=await _({method:"get",url:"https://vue3-course-api.hexschool.io/v2/api/catboxy/cart"});this.carts=t.data.data.carts,this.final_total=t.data.data.final_total,this.total=t.data.data.total,console.log("已取得購物車清單"),this.data=t.data.data},async clearAll(){const t=await _({method:"delete",url:"https://vue3-course-api.hexschool.io/v2/api/catboxy/carts"});this.data=t.data.data,console.log("已清空購物車"),this.getCart()},checkMobilePhone(t){return/^09[0-9]{8}$/.test(t)?!0:"需要正確的電話號碼"},async handleSubmit(t){await _({method:"post",url:"https://vue3-course-api.hexschool.io/v2/api/catboxy/order",data:{data:{user:{email:t.email,name:t.name,tel:t.mobilePhone,address:t.address},message:t.message}}}).catch(o=>{alert(o.response.data.message)}),this.$refs.form.resetForm(),await this.getCart()}},async mounted(){await this.getCart()}},k={class:"table align-middle"},w=e("thead",null,[e("tr",null,[e("th",null,"產品名稱"),e("th",null,"數量"),e("th",null,"單價"),e("th",null,"金額小計")])],-1),P=e("td",{colspan:"3",class:"text-end"},"總計",-1),q={class:"text-end"},S={class:"text-end"},B={class:"my-5 row-12 justify-content-center"},L={class:"mb-3"},A=e("label",{for:"email",class:"form-label"},"Email",-1),E={class:"mb-3"},F=e("label",{for:"name",class:"form-label"},"收件人姓名",-1),V={class:"mb-3"},M=e("label",{for:"mobilePhone",class:"form-label"},"收件人手機號碼",-1),N={class:"mb-3"},j=e("label",{for:"address",class:"form-label"},"收件人地址",-1),z={class:"mb-3"},D=e("label",{for:"message",class:"form-label"},"留言",-1),G=e("div",{class:"text-end"},[e("button",{type:"submit",class:"btn btn-danger"}," 送出訂單 ")],-1);function H(t,o,p,v,h,n){const l=d("v-field"),r=d("error-message"),x=d("v-form");return m(),u(b,null,[e("table",k,[w,e("tbody",null,[(m(!0),u(b,null,g(h.carts,a=>(m(),u("tr",{key:a.id},[e("td",null,c(a.product.title),1),e("td",null,c(a.qty),1),e("td",null,c(a.product.price),1),e("td",null,c(a.total),1)]))),128))]),e("tfoot",null,[e("tr",null,[P,e("td",q,c(h.total),1)])])]),e("div",S,[e("button",{class:"btn btn-outline-primary",onClick:o[0]||(o[0]=(...a)=>n.clearAll&&n.clearAll(...a))}," 清空購物車 ")]),e("div",B,[s(x,{onSubmit:n.handleSubmit,ref:"form",class:"col"},{default:y(({errors:a})=>[e("div",L,[A,s(l,{id:"email",name:"email",type:"email",class:i(["form-control",{"is-invalid":a.email}]),placeholder:"請輸入 Email",rules:"email|required"},null,8,["class"]),s(r,{name:"email",class:"invalid-feedback"})]),e("div",E,[F,s(l,{id:"name",name:"name",type:"text",class:i(["form-control",{"is-invalid":a.name}]),placeholder:"請輸入姓名",rules:"required"},null,8,["class"]),s(r,{name:"name",class:"invalid-feedback"})]),e("div",V,[M,s(l,{id:"mobilePhone",name:"mobilePhone",type:"text",class:i(["form-control",{"is-invalid":a.mobilePhone}]),placeholder:"請輸入手機號碼",rules:n.checkMobilePhone},null,8,["class","rules"]),s(r,{name:"mobilePhone",class:"invalid-feedback"})]),e("div",N,[j,s(l,{id:"address",name:"address",type:"text",class:i(["form-control",{"is-invalid":a.address}]),placeholder:"請輸入地址",rules:"required"},null,8,["class"]),s(r,{name:"address",class:"invalid-feedback"})]),e("div",z,[D,s(l,{id:"message",name:"message",class:"form-control",cols:"30",rows:"10",rules:"required",as:"textarea"})]),G]),_:1},8,["onSubmit"])])],64)}const I=f($,[["render",H]]),J={components:{ListCart:I}};function K(t,o,p,v,h,n){const l=d("ListCart");return m(),C(l)}const R=f(J,[["render",K]]);export{R as default};
